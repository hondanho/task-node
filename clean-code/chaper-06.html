<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>ChÆ°Æ¡ng 6 - Äá»‘i tÆ°á»£ng vÃ  cáº¥u trÃºc dá»¯ liá»‡u | Iâ€™m here</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="ChÆ°Æ¡ng 6 - Äá»‘i tÆ°á»£ng vÃ  cáº¥u trÃºc dá»¯ liá»‡u" />
<meta name="author" content="hondanho" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="ChÃºng tÃ´i cÃ³ lÃ½ do khi muá»‘n giá»¯ cÃ¡c biáº¿n lÃ  private. ChÃºng tÃ´i khÃ´ng muá»‘n ai Ä‘Ã³ phá»¥ thuá»™c vÃ o chÃºng. ChÃºng tÃ´i muá»‘n giá»¯ sá»± tá»± do Ä‘á»ƒ thay Ä‘á»•i kiá»ƒu (dá»¯ liá»‡u) hoáº·c thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng tÃ¹y biáº¿n. NhÆ°ng sau Ä‘Ã³ thÃ¬ sao? Ráº¥t nhiá»u láº­p trÃ¬nh viÃªn tá»± Ä‘á»™ng thÃªm getter vÃ  setter vÃ o class cá»§a há», cháº³ng khÃ¡c gÃ¬ thay Ä‘á»•i cÃ¡c biáº¿n private thÃ nh public." />
<meta property="og:description" content="ChÃºng tÃ´i cÃ³ lÃ½ do khi muá»‘n giá»¯ cÃ¡c biáº¿n lÃ  private. ChÃºng tÃ´i khÃ´ng muá»‘n ai Ä‘Ã³ phá»¥ thuá»™c vÃ o chÃºng. ChÃºng tÃ´i muá»‘n giá»¯ sá»± tá»± do Ä‘á»ƒ thay Ä‘á»•i kiá»ƒu (dá»¯ liá»‡u) hoáº·c thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng tÃ¹y biáº¿n. NhÆ°ng sau Ä‘Ã³ thÃ¬ sao? Ráº¥t nhiá»u láº­p trÃ¬nh viÃªn tá»± Ä‘á»™ng thÃªm getter vÃ  setter vÃ o class cá»§a há», cháº³ng khÃ¡c gÃ¬ thay Ä‘á»•i cÃ¡c biáº¿n private thÃ nh public." />
<link rel="canonical" href="http://localhost:4000/clean-code/chaper-06" />
<meta property="og:url" content="http://localhost:4000/clean-code/chaper-06" />
<meta property="og:site_name" content="Iâ€™m here" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-08-23T00:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="ChÆ°Æ¡ng 6 - Äá»‘i tÆ°á»£ng vÃ  cáº¥u trÃºc dá»¯ liá»‡u" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"hondanho"},"dateModified":"2024-08-23T00:00:00+07:00","datePublished":"2024-08-23T00:00:00+07:00","description":"ChÃºng tÃ´i cÃ³ lÃ½ do khi muá»‘n giá»¯ cÃ¡c biáº¿n lÃ  private. ChÃºng tÃ´i khÃ´ng muá»‘n ai Ä‘Ã³ phá»¥ thuá»™c vÃ o chÃºng. ChÃºng tÃ´i muá»‘n giá»¯ sá»± tá»± do Ä‘á»ƒ thay Ä‘á»•i kiá»ƒu (dá»¯ liá»‡u) hoáº·c thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng tÃ¹y biáº¿n. NhÆ°ng sau Ä‘Ã³ thÃ¬ sao? Ráº¥t nhiá»u láº­p trÃ¬nh viÃªn tá»± Ä‘á»™ng thÃªm getter vÃ  setter vÃ o class cá»§a há», cháº³ng khÃ¡c gÃ¬ thay Ä‘á»•i cÃ¡c biáº¿n private thÃ nh public.","headline":"ChÆ°Æ¡ng 6 - Äá»‘i tÆ°á»£ng vÃ  cáº¥u trÃºc dá»¯ liá»‡u","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/clean-code/chaper-06"},"url":"http://localhost:4000/clean-code/chaper-06"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="I'm here" /></head>
<body><header class="site-header">

  <div class="wrapper"><a href="/" title="">
      Archive
    </a>
    <a href="/category.html">
      Categories
    </a>
    <p>The latest tips and news from the hondanho blog</p></div>
</header>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    var backToTopBtn = document.getElementById("back-to-top");

    window.addEventListener("scroll", function () {
      if (window.pageYOffset > 300) {
        backToTopBtn.style.display = "block";
      } else {
        backToTopBtn.style.display = "none";
      }
    });

    backToTopBtn.addEventListener("click", function (event) {
      event.preventDefault();
      window.scrollTo({
        top: 0,
        behavior: "smooth"
      });
    });
  });
</script><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">ChÆ°Æ¡ng 6 - Äá»‘i tÆ°á»£ng vÃ  cáº¥u trÃºc dá»¯ liá»‡u</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2024-08-23T00:00:00+07:00" itemprop="datePublished">Aug 23, 2024
      </time>â€¢ posted on  <a class="category-name" href="/category/clean-code">clean-code</a></p>
        
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>ChÃºng tÃ´i cÃ³ lÃ½ do khi muá»‘n giá»¯ cÃ¡c biáº¿n lÃ  private. ChÃºng tÃ´i khÃ´ng muá»‘n ai Ä‘Ã³ phá»¥ thuá»™c vÃ o chÃºng. ChÃºng tÃ´i muá»‘n giá»¯ sá»± tá»± do Ä‘á»ƒ thay Ä‘á»•i kiá»ƒu (dá»¯ liá»‡u) hoáº·c thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng tÃ¹y biáº¿n. NhÆ°ng sau Ä‘Ã³ thÃ¬ sao? Ráº¥t nhiá»u láº­p trÃ¬nh viÃªn tá»± Ä‘á»™ng thÃªm getter vÃ  setter vÃ o class cá»§a há», cháº³ng khÃ¡c gÃ¬ thay Ä‘á»•i cÃ¡c biáº¿n <code class="language-plaintext highlighter-rouge">private</code> thÃ nh <code class="language-plaintext highlighter-rouge">public</code>.</p>

<h2 id="trá»«u-tÆ°á»£ng-hÃ³a-dá»¯-liá»‡u">Trá»«u tÆ°á»£ng hÃ³a dá»¯ liá»‡u</h2>

<p>HÃ£y xem xÃ©t sá»± khÃ¡c biá»‡t giá»¯a Listing 6-1 vÃ  Listing 6-2. Cáº£ hai Ä‘á»u Ä‘áº¡i diá»‡n cho dá»¯ liá»‡u cá»§a má»™t Ä‘iá»ƒm trong há»‡ tá»a Ä‘á»™ Descartes. Tuy nhiÃªn, má»™t cÃ¡i thÃ¬ Ä‘á»ƒ lá»™ viá»‡c triá»ƒn khai trong khi cÃ¡i cÃ²n láº¡i thÃ¬ khÃ´ng.</p>

<p>| Listing 6-1 <strong>Concrete Point</strong> |
| â€” |</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Point</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="n">x</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="n">y</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>| Listing 6-2 <strong>Abstract Point</strong> |
| â€” |</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Point</span> <span class="o">{</span>
    <span class="kt">double</span> <span class="nf">getX</span><span class="o">();</span>
    <span class="kt">double</span> <span class="nf">getY</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">setCartesian</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">);</span>
    <span class="kt">double</span> <span class="nf">getR</span><span class="o">();</span>
    <span class="kt">double</span> <span class="nf">getTheta</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">setPolar</span><span class="o">(</span><span class="kt">double</span> <span class="n">r</span><span class="o">,</span> <span class="kt">double</span> <span class="n">theta</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>CÃ¡i hay cá»§a Listing 6-2 lÃ  khÃ´ng cÃ³ cÃ¡ch nÃ o báº¡n biáº¿t Ä‘Æ°á»£c viá»‡c triá»ƒn khai interface sáº½ Ä‘Æ°á»£c dÃ¹ng cho hÃ¬nh chá»¯ nháº­t hay cÃ¡c gÃ³c tá»a Ä‘á»™, hoáº·c khÃ´ng gÃ¬ cáº£. <code class="language-plaintext highlighter-rouge">Interface</code> rÃµ rÃ ng lÃ  má»™t dáº¡ng cáº¥u trÃºc dá»¯ liá»‡u.</p>

<p>NhÆ°ng nÃ³ khÃ´ng chá»‰ lÃ  má»™t dáº¡ng cáº¥u trÃºc dá»¯ liá»‡u. CÃ¡c phÆ°Æ¡ng thá»©c tuÃ¢n theo má»™t chÃ­nh sÃ¡ch truy cáº­p duy nháº¥t. Báº¡n cÃ³ thá»ƒ Ä‘á»c cÃ¡c tá»a Ä‘á»™ riÃªng láº» má»™t cÃ¡ch Ä‘á»™c láº­p, nhÆ°ng báº¡n pháº£i Ä‘áº·t cÃ¡c tá»a Ä‘á»™ láº¡i vá»›i nhau Ä‘á»ƒ táº¡o nÃªn má»™t hoáº¡t Ä‘á»™ng nguyÃªn tá»­.</p>

<p>Listing 6-1, máº·t khÃ¡c, thá»ƒ hiá»‡n ráº¥t rÃµ rÃ ng cÃ¡c tá»a Ä‘á»™ thuá»™c vá» hÃ¬nh chá»¯ nháº­t vÃ  nÃ³ buá»™c chÃºng ta pháº£i thao tÃ¡c vá»›i cÃ¡c tá»a Ä‘á»™ Ä‘Ã³ má»™t cÃ¡ch Ä‘á»™c láº­p. Äiá»u nÃ y lÃ m lá»™ dá»¯ liá»‡u ngay cáº£ khi cÃ¡c biáº¿n lÃ  <code class="language-plaintext highlighter-rouge">private</code> vÃ  chÃºng tÃ´i Ä‘ang sá»­ dá»¥ng cÃ¡c getter/setter.</p>

<p>áº¨n viá»‡c triá»ƒn khai khÃ´ng Ä‘Æ¡n giáº£n lÃ  viá»‡c Ä‘áº·t má»™t biáº¿n vÃ o giá»¯a cÃ¡c hÃ m, Ä‘Ã³ lÃ  váº¥n Ä‘á» trá»«u tÆ°á»£ng hÃ³a. Má»™t class khÃ´ng chá»‰ Ä‘Æ¡n giáº£n lÃ  Ä‘áº©y cÃ¡c biáº¿n cá»§a nÃ³ thÃ´ng qua cÃ¡c getter/setter. Thay vÃ o Ä‘Ã³ nÃ³ cung cáº¥p cÃ¡c <code class="language-plaintext highlighter-rouge">abstract interface</code> cho phÃ©p ngÆ°á»i dÃ¹ng thao tÃ¡c vá»›i báº£n cháº¥t cá»§a dá»¯ liá»‡u mÃ  khÃ´ng cáº§n quan tÃ¢m Ä‘áº¿n cÃ¡ch chÃºng hoáº¡t Ä‘á»™ng.</p>

<p>HÃ£y xem xÃ©t Listing 6-3 vÃ  Listing 6-4. CÃ¡i Ä‘áº§u tiÃªn sá»­ dá»¥ng cÃ¡c thuáº­t ngá»¯ cá»¥ thá»ƒ Ä‘á»ƒ chá»‰ ra má»©c nhiÃªn liá»‡u cá»§a má»™t phÆ°Æ¡ng tiá»‡n (vehicle), trong khi cÃ¡i thá»© hai lÃ m Ä‘iá»u tÆ°Æ¡ng tá»± nhÆ°ng vá»›i tá»‰ lá»‡ pháº§n trÄƒm. Trong trÆ°á»ng há»£p cá»¥ thá»ƒ, báº¡n cÃ³ thá»ƒ cháº¯c cháº¯n ráº±ng Ä‘Ã¢y chá»‰ lÃ  nhá»¯ng truy xuáº¥t Ä‘áº¿n cÃ¡c biáº¿n. Trong trÆ°á»ng há»£p trá»«u tÆ°á»£ng, báº¡n hoÃ n toÃ n khÃ´ng cÃ³ manh má»‘i nÃ o vá» hÃ¬nh thá»©c cá»§a dá»¯ liá»‡u.</p>

<p>| Listing 6-3 <strong>Concrete Vehicle</strong> |
| â€” |</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Vehicle</span> <span class="o">{</span>
    <span class="kt">double</span> <span class="nf">getFuelTankCapacityInGallons</span><span class="o">();</span>
    <span class="kt">double</span> <span class="nf">getGallonsOfGasoline</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>| Listing 6-4 <strong>Abstract Vehicle</strong> |
| â€” |</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Vehicle</span> <span class="o">{</span>
    <span class="kt">double</span> <span class="nf">getPercentFuelRemaining</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Trong hai trÆ°á»ng há»£p trÃªn, tÃ¹y chá»n thá»© hai lÃ  thÃ­ch há»£p hÆ¡n. ChÃºng tÃ´i khÃ´ng muá»‘n tiáº¿t lá»™ chi tiáº¿t vá» dá»¯ liá»‡u, thay vÃ o Ä‘Ã³ chÃºng tÃ´i muá»‘n giá»¯ dá»¯ liá»‡u cá»§a chÃºng tÃ´i á»Ÿ cÃ¡c dáº¡ng trá»«u tÆ°á»£ng. Äiá»u nÃ y khÃ´ng chá»‰ Ä‘Æ¡n thuáº§n Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c <strong>interface</strong> vÃ /hoáº·c getter vÃ  setter. Sá»­ dá»¥ng getter/setter lÃ  tÃ¹y chá»n tá»“i tá»‡ nháº¥t mÃ  tÃ´i sáº½ thá»±c hiá»‡n.</p>

<h2 id="cáº¥u-trÃºc-dá»¯-liá»‡u-vÃ -Ä‘á»‘i-tÆ°á»£ng">Cáº¥u trÃºc dá»¯ liá»‡u vÃ  Ä‘á»‘i tÆ°á»£ng</h2>

<p>Hai vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y cho tháº¥y sá»± khÃ¡c biá»‡t giá»¯a cÃ¡c Ä‘á»‘i tÆ°á»£ng vÃ  dá»¯ liá»‡u cÃ³ cáº¥u trÃºc. CÃ¡c Ä‘á»‘i tÆ°á»£ng áº©n dá»¯ liá»‡u cá»§a chÃºng bÃªn dÆ°á»›i viá»‡c trá»«u tÆ°á»£ng hÃ³a vÃ  Ä‘Æ°a ra cÃ¡c hÃ m dá»±a trÃªn dá»¯ liá»‡u Ä‘Ã³. Dá»¯ liá»‡u cÃ³ cáº¥u trÃºc phÆ¡i bÃ y dá»¯ liá»‡u cá»§a chÃºng vÃ  khÃ´ng cÃ³ cÃ¡c hÃ m cÃ³ nhiá»u Ã½ nghÄ©a. Quay láº¡i vÃ  Ä‘á»c nÃ³ má»™t láº§n ná»¯a. LÆ°u Ã½ báº£n cháº¥t cá»§a hai Ä‘á»‹nh nghÄ©a. ChÃºng thá»±c sá»± Ä‘á»‘i láº­p nhau. Sá»± khÃ¡c biá»‡t nÃ y cÃ³ váº» khÃ´ng Ä‘Ã¡ng ká»ƒ, nhÆ°ng nÃ³ cÃ³ áº£nh hÆ°á»Ÿng sÃ¢u Ä‘áº¿n há»‡ thá»‘ng.</p>

<p>VÃ­ dá»¥, xem xÃ©t vÃ­ dá»¥ vá» cÃ¡c class liÃªn quan Ä‘áº¿n hÃ¬nh há»c trong Listing 6-5. Class Geometry hoáº¡t Ä‘á»™ng vá»›i dá»¯ liá»‡u cá»§a ba class khÃ¡c. (CÃ¡c class khÃ¡c nÃ y) lÃ  cÃ¡c <em>cáº¥u trÃºc dá»¯ liá»‡u</em> Ä‘Æ¡n giáº£n mÃ  khÃ´ng cÃ³ báº¥t ká»³ phÆ°Æ¡ng thá»©c nÃ o. CÃ¡c hÃ nh Ä‘á»™ng Ä‘á»u thuá»™c vá» class Geometry.</p>

<p>| Listing 6-5 <strong>Procedural Shape</strong> |
| â€” |</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Square</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Point</span> <span class="n">topLeft</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="n">side</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Rectangle</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Point</span> <span class="n">topLeft</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="n">height</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="n">width</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Circle</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Point</span> <span class="n">center</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="n">radius</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Geometry</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">double</span> <span class="no">PI</span> <span class="o">=</span> <span class="mf">3.141592653589793</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">(</span><span class="nc">Object</span> <span class="n">shape</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">NoSuchShapeException</span>
    <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Square</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Square</span> <span class="n">s</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Square</span><span class="o">)</span><span class="n">shape</span><span class="o">;</span>
            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="na">side</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="na">side</span><span class="o">;</span>
        <span class="o">}</span><span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Rectangle</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Rectangle</span> <span class="n">r</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Rectangle</span><span class="o">)</span><span class="n">shape</span><span class="o">;</span>
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="na">height</span> <span class="o">*</span> <span class="n">r</span><span class="o">.</span><span class="na">width</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">shape</span> <span class="k">instanceof</span> <span class="nc">Circle</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Circle</span> <span class="n">c</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Circle</span><span class="o">)</span><span class="n">shape</span><span class="o">;</span>
            <span class="k">return</span> <span class="no">PI</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="na">radius</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="na">radius</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">NoSuchShapeException</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>CÃ¡c láº­p trÃ¬nh viÃªn hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ khÃ´ng Ä‘á»“ng Ã½ vá»›i Ä‘iá»u nÃ y vÃ  cho ráº±ng Ä‘Ã³ lÃ  má»™t phÆ°Æ¡ng phÃ¡p cá»§a há» - vÃ  chÃºng Ä‘Ãºng. NhÆ°ng ngÆ°á»i khÃ¡c cÃ³ thá»ƒ nhÃ¬n vÃ o vÃ  chÃª cÆ°á»i vÃ¬ chÃºng cÃ³ kháº£ nÄƒng khÃ´ng Ä‘Æ°á»£c quan tÃ¢m vÃ  báº£o trÃ¬. Chuyá»‡n gÃ¬ xáº£y ra náº¿u tÃ´i thÃªm vÃ o class Geometry má»™t hÃ m tÃ­nh chu vi? KhÃ´ng sao cáº£, cÃ¡c class bÃªn trÃªn nÃ³ sáº½ khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng. NhÆ°ng náº¿u tÃ´i thÃªm vÃ o má»™t class má»›i liÃªn quan Ä‘áº¿n hÃ¬nh há»c (Triangle cháº³ng háº¡n), tÃ´i pháº£i thay Ä‘á»•i cÃ¡c hÃ m trong class Geometry Ä‘á»ƒ phÃ¹ há»£p vá»›i nÃ³. Äá»c láº¡i nÃ³ láº§n ná»¯a. LÆ°u Ã½ ráº±ng chÃºng tháº­t sá»± Ä‘á»‘i láº­p nhau.</p>

<p>BÃ¢y giá» hÃ£y xem giáº£i phÃ¡p á»Ÿ Listing 6-6. PhÆ°Æ¡ng thá»©c <code class="language-plaintext highlighter-rouge">area()</code> á»Ÿ Ä‘Ã¢y lÃ  Ä‘a hÃ¬nh, khÃ´ng cáº§n class Geometry, vÃ¬ váº­y náº¿u tÃ´i thÃªm má»™t class hÃ¬nh há»c má»›i, sáº½ khÃ´ng cÃ³ hÃ m nÃ o cáº§n thay Ä‘á»•i. NhÆ°ng náº¿u tÃ´i thÃªm má»™t hÃ m má»›i, táº¥t cáº£ cÃ¡c class káº¿ thá»«a bÃªn dÆ°á»›i Ä‘á»u cáº§n pháº£i thay Ä‘á»•i!</p>

<p>| Listing 6-6 <strong>Polymorphic Shapes</strong> |
| â€” |</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Square</span> <span class="kd">implements</span> <span class="nc">Shape</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Point</span> <span class="n">topLeft</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">side</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">side</span><span class="o">*</span><span class="n">side</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Rectangle</span> <span class="kd">implements</span> <span class="nc">Shape</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Point</span> <span class="n">topLeft</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">height</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">width</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">height</span> <span class="o">*</span> <span class="n">width</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Circle</span> <span class="kd">implements</span> <span class="nc">Shape</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Point</span> <span class="n">center</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">radius</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="kt">double</span> <span class="no">PI</span> <span class="o">=</span> <span class="mf">3.141592653589793</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">PI</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">radius</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Má»™t láº§n ná»¯a, chÃºng ta tháº¥y sá»± Ä‘á»‘i láº­p giá»¯a hai váº¥n Ä‘á» nÃ y. Äiá»u nÃ y chá»‰ ra sá»± khÃ¡c biá»‡t cÆ¡ báº£n giá»¯a cÃ¡c Ä‘á»‘i tÆ°á»£ng vÃ  cáº¥u trÃºc dá»¯ liá»‡u:</p>

<blockquote>
  <p><em>CÃ¡c dÃ²ng code sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p cáº¥u trÃºc dá»¯ liá»‡u giÃºp dá»… dÃ ng thÃªm cÃ¡c hÃ m má»›i mÃ  khÃ´ng cáº§n pháº£i thay Ä‘á»•i cáº¥u trÃºc cá»§a dá»¯ liá»‡u hiá»‡n táº¡i. Máº·t khÃ¡c, code theo phÆ°Æ¡ng phÃ¡p hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng giÃºp dá»… dÃ ng thÃªm cÃ¡c class má»›i mÃ  khÃ´ng thay Ä‘á»•i cÃ¡c hÃ m Ä‘Ã£ viáº¿t.</em></p>
</blockquote>

<p>Báº¡n cÅ©ng cÃ³ thá»ƒ hiá»ƒu nÃ³ nhÆ° sau:</p>

<blockquote>
  <p><em>Code theo cáº¥u trÃºc dá»¯ liá»‡u lÃ m báº¡n khÃ³ thÃªm dá»¯ liá»‡u má»›i vÃ¬ pháº£i thay Ä‘á»•i toÃ n bá»™ hÃ m. Code theo hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng lÃ m báº¡n khÃ³ thÃªm hÃ m vÃ¬ pháº£i thay Ä‘á»•i táº¥t cáº£ cÃ¡c class chá»‹u áº£nh hÆ°á»Ÿng.</em></p>
</blockquote>

<p>Váº­y lÃ , Æ°u Ä‘iá»ƒm cá»§a phÆ°Æ¡ng phÃ¡p nÃ y láº¡i lÃ  nhÆ°á»£c Ä‘iá»ƒm cá»§a phÆ°Æ¡ng phÃ¡p kia, vÃ  ngÆ°á»£c láº¡i.</p>

<p>Trong báº¥t ká»³ há»‡ thá»‘ng nÃ o, sáº½ cÃ³ lÃºc chÃºng ta muá»‘n bá»• sung cÃ¡c kiá»ƒu dá»¯ liá»‡u má»›i thay vÃ¬ cÃ¡c hÃ m má»›i. Trong trÆ°á»ng há»£p nÃ y phÆ°Æ¡ng phÃ¡p hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng sáº½ phÃ¹ há»£p hÆ¡n. NhÆ°ng cÅ©ng cÃ³ lÃºc chÃºng ta muá»‘n thÃªm hÃ m má»›i thay vÃ¬ thÃªm dá»¯ liá»‡u. Trong trÆ°á»ng há»£p nÃ y, cáº¥u trÃºc dá»¯ liá»‡u nÃªn Ä‘Æ°á»£c Æ°u tiÃªn hÆ¡n.</p>

<p>CÃ¡c láº­p trÃ¬nh viÃªn giÃ u kinh nghiá»‡m biáº¿t ráº±ng Ã½ tÆ°á»Ÿng <em>Ä‘á»‘i tÆ°á»£ng hÃ³a</em> má»i thá»© lÃ  chuyá»‡n hoang Ä‘Æ°á»ng. ÄÃ´i khi báº¡n cáº§n cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u Ä‘Æ¡n giáº£n Ä‘á»ƒ phÃ¡t triá»ƒn cÃ¡c hÃ m trÃªn chÃºng.</p>

<h2 id="the-law-of-demeter">The Law of Demeter</h2>

<p>CÃ³ má»™t ká»¹ thuáº­t ná»•i tiáº¿ng Ä‘Æ°á»£c gá»i lÃ  <em>Law of Demeter</em>, nÃ³i ráº±ng má»™t module khÃ´ng nÃªn biáº¿t vá» thÃ nh pháº§n bÃªn trong cá»§a má»™t Ä‘á»‘i tÆ°á»£ng mÃ  nÃ³ sá»­ dá»¥ng. NhÆ° chÃºng ta Ä‘Ã£ tháº¥y trong cÃ¡c pháº§n trÆ°á»›c, cÃ¡c Ä‘á»‘i tÆ°á»£ng áº©n dá»¯ liá»‡u cá»§a chÃºng vÃ  Ä‘Æ°a ra nhá»¯ng phÆ°Æ¡ng thá»©c. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ´ng nÃªn phÆ¡i bÃ y cáº¥u trÃºc cá»§a chÃºng thÃ´ng qua cÃ¡c getter/setter vÃ¬ viá»‡c nÃ y lÃ m lá»™ cáº¥u trÃºc bÃªn trong nÃ³, Ä‘iá»u chÃºng ta cáº§n lÃ m lÃ  áº©n chÃºng Ä‘i.</p>

<p>Cá»¥ thá»ƒ, Law of Demeter nÃ³i ráº±ng má»™t phÆ°Æ¡ng thá»©c <em>f</em> cá»§a class <em>C</em> chá»‰ nÃªn gá»i nhá»¯ng phÆ°Æ¡ng thá»©c sau:</p>

<ul>
  <li><em>C</em></li>
  <li>Má»™t Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c táº¡o bá»Ÿi <em>f</em></li>
  <li>Má»™t Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c truyá»n vÃ o dÆ°á»›i dáº¡ng Ä‘á»‘i sá»‘ cá»§a <em>f</em></li>
  <li>Má»™t Ä‘á»‘i tÆ°á»£ng chá»©a má»™t biáº¿n instance cá»§a <em>C</em></li>
</ul>

<p>HÃ m khÃ´ng nÃªn gá»i cÃ¡c phÆ°Æ¡ng thá»©c khÃ¡c cá»§a phÆ°Æ¡ng thá»©c khÃ¡c. NÃ³i cÃ¡ch khÃ¡c, chá»‰ lÃ m viá»‡c vá»›i báº¡n bÃ¨, khÃ´ng lÃ m viá»‡c vá»›i ngÆ°á»i láº¡.</p>

<p>Äoáº¡n code sau dÆ°á»ng nhÆ° vi pháº¡m Law of Demeter vÃ¬ nÃ³ gá»i hÃ m <code class="language-plaintext highlighter-rouge">getScratchDir()</code> báº±ng giÃ¡ trá»‹ tráº£ vá» cá»§a <code class="language-plaintext highlighter-rouge">getOptions()</code>, vÃ  sau Ä‘Ã³ gá»i <code class="language-plaintext highlighter-rouge">getAbsolutePath()</code> báº±ng giÃ¡ trá»‹ tráº£ vá» cá»§a <code class="language-plaintext highlighter-rouge">getScratchDir()</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="nc">String</span> <span class="n">outputDir</span> <span class="o">=</span> <span class="n">ctxt</span><span class="o">.</span><span class="na">getOptions</span><span class="o">().</span><span class="na">getScratchDir</span><span class="o">().</span><span class="na">getAbsolutePath</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="train-wrecks">Train Wrecks</h3>

<p>Dáº¡ng code nÃ y thÆ°á»ng Ä‘Æ°á»£c gá»i lÃ  <em>train wreck</em> (Ä‘oÃ n tÃ u pháº¿ liá»‡u ğŸ˜„) vÃ¬ nÃ³ trÃ´ng giá»‘ng nhÆ° má»™t loáº¡t cÃ¡c toa tÃ u Ä‘Æ°á»£c ghÃ©p láº¡i vá»›i nhau. CÃ¡c chuá»—i lá»i gá»i hÃ m nhÆ° tháº¿ nÃ y Ä‘Æ°á»£c coi lÃ  biá»ƒu hiá»‡n cá»§a sá»± cáº©u lÆ°Æ¡ng vÃ  nÃªn trÃ¡nh chÃºng. CÃ¡ch tá»‘t nháº¥t lÃ  nÃªn tÃ¡ch chÃºng ra nhÆ° sau:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Options</span> <span class="n">opts</span> <span class="o">=</span> <span class="n">ctxt</span><span class="o">.</span><span class="na">getOptions</span><span class="o">();</span>
<span class="nc">File</span> <span class="n">scratchDir</span> <span class="o">=</span> <span class="n">opts</span><span class="o">.</span><span class="na">getScratchDir</span><span class="o">();</span>
<span class="kd">final</span> <span class="nc">String</span> <span class="n">outputDir</span> <span class="o">=</span> <span class="n">scratchDir</span><span class="o">.</span><span class="na">getAbsolutePath</span><span class="o">();</span>
</code></pre></div></div>

<p>![chap06_img01.png](../assets/image/chap06_img01.png â€œâ€)</p>

<p>Äoáº¡n code trÃªn cÃ³ vi pháº¡m Law of Demeter (LoD)? Cháº¯c cháº¯n module chá»©a chÃºng biáº¿t ráº±ng Ä‘á»‘i tÆ°á»£ng <code class="language-plaintext highlighter-rouge">ctxt</code> chá»©a <code class="language-plaintext highlighter-rouge">Options</code>, cÃ³ <code class="language-plaintext highlighter-rouge">AbsolutePath</code> (Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i). QuÃ¡ nhiá»u thÃ´ng tin bá»‹ lá»™ ra.[â€¦]</p>

<p>NhÆ°ng viá»‡c nÃ³ cÃ³ vi pháº¡m LoD cÃ²n phá»¥ thuá»™c vÃ o <code class="language-plaintext highlighter-rouge">ctxt</code>, <code class="language-plaintext highlighter-rouge">Options</code> vÃ  <code class="language-plaintext highlighter-rouge">ScratchDir</code> lÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng hay chá»‰ Ä‘Æ¡n thuáº§n lÃ  cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u. Náº¿u chÃºng lÃ  Ä‘á»‘i tÆ°á»£ng, thÃ¬ cáº¥u trÃºc bÃªn trong chÃºng nÃªn Ä‘Æ°á»£c áº©n Ä‘i chá»© khÃ´ng nÃªn Ä‘á»ƒ lá»™ thiÃªn nhÆ° tháº¿, vÃ  viá»‡c Ä‘á»ƒ lá»™ thÃ´ng tin vá» dá»¯ liá»‡u bÃªn trong chÃºng rÃµ rÃ ng lÃ  vi pháº¡m LoD. Máº·t khÃ¡c, náº¿u <code class="language-plaintext highlighter-rouge">ctxt</code>, <code class="language-plaintext highlighter-rouge">Options</code> vÃ  <code class="language-plaintext highlighter-rouge">ScratchDir</code> chá»‰ lÃ  cÃ¡c cáº¥u trÃºc khÃ´ng cÃ³ hÃ m xá»­ lÃ½, thÃ¬ viá»‡c lá»™ dá»¯ liá»‡u bÃªn trong chÃºng lÃ  hiá»ƒn nhiÃªn vÃ  LoD khÃ´ng Ä‘Æ°á»£c Ã¡p dá»¥ng trong trÆ°á»ng há»£p nÃ y.</p>

<p>Viá»‡c sá»­ dá»¥ng cÃ¡c hÃ m truy cáº­p (getter/setter) lÃ m váº¥n Ä‘á» trá»Ÿ nÃªn máº­p má». Náº¿u code Ä‘Æ°á»£c viáº¿t nhÆ° sau thÃ¬ cÃ³ láº½ chÃºng ta sáº½ thÃ´i cháº¥t váº¥n nhau vá» LoD:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="nc">String</span> <span class="n">outputDir</span> <span class="o">=</span> <span class="n">ctxt</span><span class="o">.</span><span class="na">options</span><span class="o">.</span><span class="na">scratchDir</span><span class="o">.</span><span class="na">absolutePath</span><span class="o">;</span>
</code></pre></div></div>

<p>Váº¥n Ä‘á» nÃ y sáº½ Ã­t gÃ¢y nháº§m láº«n hÆ¡n náº¿u cÃ¡c cáº¥u trÃºc Ä‘Æ¡n giáº£n chá»‰ cÃ³ biáº¿n public vÃ  khÃ´ng cÃ³ phÆ°Æ¡ng thá»©c, trong khi cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ cÃ¡c biáº¿n private vÃ  cÃ¡c hÃ m public. Tuy nhiÃªn, má»™t vÃ i framework yÃªu cáº§u ráº±ng ngay cáº£ cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u Ä‘Æ¡n giáº£n cÅ©ng cáº§n pháº£i cÃ³ cÃ¡c hÃ m truy cáº­p.</p>

<h3 id="con-lai">Con lai</h3>

<p>Sá»± nháº§m láº«n nÃ y Ä‘Ã´i khi táº¡o nÃªn cÃ¡c Ä‘á»©a con lai, mang ná»­a dÃ²ng mÃ¡u Ä‘á»‘i tÆ°á»£ng vÃ  má»™t ná»­a cÃ²n láº¡i lÃ  cáº¥u trÃºc. ChÃºng cÃ³ cÃ¡c hÃ m lÃ m nhá»¯ng viá»‡c quan trá»ng, chÃºng cÅ©ng cÃ³ cÃ¡c biáº¿n public hoáº·c cÃ¡c hÃ m truy cáº­p public,â€¦vá»›i má»¥c Ä‘Ã­ch cuá»‘i cÃ¹ng lÃ  hÃ´ biáº¿n cÃ¡c biáº¿n private thÃ nh public, dá»¥ dá»— cÃ¡c hÃ m bÃªn ngoÃ i sá»­ dá»¥ng cÃ¡c biáº¿n private (thÃ´ng qua getter/setter) nhÆ° má»™t cáº¥u trÃºc Ä‘Æ¡n giáº£n.</p>

<p>Nhá»¯ng Ä‘á»©a con lai nÃ y khiáº¿n cho viá»‡c thÃªm má»›i hÃ m trá»Ÿ nÃªn khÃ³ khÄƒn, vÃ  viá»‡c thÃªm thuá»™c tÃ­nh má»›i cÅ©ng khÃ³ khÄƒn ná»‘t ğŸ™‚. ChÃºng lÃ  thá»© tá»“i tá»‡ nháº¥t mÃ  báº¡n sáº½ táº¡o ra, váº­y nÃªn Ä‘á»«ng táº¡o ra chÃºng. ChÃºng lÃ  dáº¥u hiá»‡u cho tháº¥y má»™t thiáº¿t káº¿ nhÆ° sh!t cá»§a láº­p trÃ¬nh viÃªn nÃ o Ä‘áº¥y táº¡o ra mÃ  khÃ´ng cháº¯c thá»© anh áº¥y Ä‘ang táº¡o ra lÃ  gÃ¬ â€“ má»™t cáº¥u trÃºc Ä‘Æ¡n giáº£n vá»›i nhiá»u dá»¯ liá»‡u hay má»™t Ä‘á»‘i tÆ°á»£ng vá»›i nhiá»u phÆ°Æ¡ng thá»©c.</p>

<h3 id="áº©n-cáº¥u-trÃºc">áº¨n cáº¥u trÃºc</h3>

<p>Äiá»u gÃ¬ xáº£y ra náº¿u <code class="language-plaintext highlighter-rouge">ctxt</code>, <code class="language-plaintext highlighter-rouge">Options</code> vÃ  <code class="language-plaintext highlighter-rouge">ScratchDir</code> lÃ  cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ hÃ nh vi thá»±c sá»±? Náº¿u váº­y, chÃºng pháº£i giáº¥u cáº¥u trÃºc bÃªn trong Ä‘i, vÃ  chÃºng ta khÃ´ng thá»ƒ lÃ m gÃ¬ vá»›i chÃºng. Váº­y thÃ¬ chÃºng ta láº¥y Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i (AbsolutePath) cá»§a thÆ° má»¥c báº±ng cÃ¡ch nÃ o?</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ctxt</span><span class="o">.</span><span class="na">getAbsolutePathOfScratchDirectoryOption</span><span class="o">();</span>
</code></pre></div></div>

<p>hay</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ctx</span><span class="o">.</span><span class="na">getScratchDirectoryOption</span><span class="o">().</span><span class="na">getAbsolutePath</span><span class="o">();</span>
</code></pre></div></div>

<p>Lá»±a chá»n Ä‘áº§u tiÃªn cÃ³ thá»ƒ phÃ¡t sinh ra hÃ ng loáº¡t phÆ°Æ¡ng thá»©c chá»“ng chÃ©o nhau bÃªn trong Ä‘á»‘i tÆ°á»£ng <code class="language-plaintext highlighter-rouge">ctxt</code>. Lá»±a chá»n thá»© hai cho ráº±ng <code class="language-plaintext highlighter-rouge">getScratchDirectoryOption()</code> tráº£ vá» má»™t cáº¥u trÃºc, khÃ´ng pháº£i má»™t Ä‘á»‘i tÆ°á»£ng. KhÃ´ng cÃ³ lá»±a chá»n nÃ o Ä‘á»§ tá»‘t.</p>

<p>Náº¿u <code class="language-plaintext highlighter-rouge">ctxt</code> lÃ  má»™t Ä‘á»‘i tÆ°á»£ng, chÃºng ta nÃªn báº£o nÃ³ lÃ m gÃ¬ Ä‘Ã³, khÃ´ng nÃªn há»i nÃ³ vá» cáº¥u trÃºc bÃªn trong nÃ³. Váº­y táº¡i sao chÃºng ta muá»‘n Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i cá»§a thÆ° má»¥c? ChÃºng ta sáº½ lÃ m gÃ¬ vá»›i nÃ³? Xem xÃ©t Ä‘oáº¡n code nÃ y (láº¥y tá»« vÃ i dÃ²ng xa hÆ¡n bÃªn dÆ°á»›i) trong cÃ¹ng má»™t module:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">outFile</span> <span class="o">=</span> <span class="n">outputDir</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="n">className</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="sc">'.'</span><span class="o">,</span> <span class="sc">'/'</span><span class="o">)</span> <span class="o">+</span> <span class="s">".class"</span><span class="o">;</span>
<span class="nc">FileOutputStream</span> <span class="n">fout</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="n">outFile</span><span class="o">);</span>
<span class="nc">BufferedOutputStream</span> <span class="n">bos</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedOutputStream</span><span class="o">(</span><span class="n">fout</span><span class="o">);</span>
</code></pre></div></div>

<p>CÃ¡c chi tiáº¿t khÃ¡c nhau táº¡o nÃªn má»™t chÃºt ráº¯c rá»‘i á»Ÿ Ä‘Ã¢y. Dáº¥u cháº¥m, dáº¥u gáº¡ch chÃ©o, pháº§n má»Ÿ rá»™ng cá»§a file, [â€¦]. Bá» qua Ä‘iá»u Ä‘Ã³, chÃºng tÃ´i tháº¥y ráº±ng má»¥c Ä‘Ã­ch cá»§a viá»‡c láº¥y Ä‘Æ°á»ng dáº«n tuyá»‡t Ä‘á»‘i lÃ  Ä‘á»ƒ táº¡o má»™t tá»‡p vá»›i tÃªn cá»¥ thá»ƒ.</p>

<p>Váº­y thÃ¬ Ä‘iá»u gÃ¬ sáº½ xáº£y ra náº¿u chÃºng tÃ´i báº£o Ä‘á»‘i tÆ°á»£ng ctxt thá»±c hiá»‡n viá»‡c nÃ y?</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">BufferedOutputStream</span> <span class="n">bos</span> <span class="o">=</span> <span class="n">ctxt</span><span class="o">.</span><span class="na">createScratchFileStream</span><span class="o">(</span><span class="n">classFileName</span><span class="o">);</span>
</code></pre></div></div>

<p>KhÃ¡ há»£p lÃ½! Äiá»u nÃ y cho phÃ©p <code class="language-plaintext highlighter-rouge">ctxt</code> áº©n ná»™i dung bÃªn trong nÃ³ vÃ  ngÄƒn hÃ m hiá»‡n táº¡i vi pháº¡m LoD báº±ng cÃ¡ch Ä‘iá»u hÆ°á»›ng qua cÃ¡c Ä‘á»‘i tÆ°á»£ng mÃ  module khÃ´ng biáº¿t.</p>

<h2 id="data-transfer-objects">Data Transfer Objects</h2>

<p>Dáº¡ng thuáº§n tÃºy cá»§a cáº¥u trÃºc dá»¯ liá»‡u lÃ  má»™t class cÃ³ cÃ¡c biáº¿n public vÃ  khÃ´ng cÃ³ hÃ m. Dáº¡ng nÃ y Ä‘Ã´i khi Ä‘Æ°á»£c gá»i lÃ  má»™t Ä‘á»‘i tÆ°á»£ng truyá»n dá»¯ liá»‡u (Data transfer object), hoáº·c DTO. CÃ¡c DTO lÃ  cáº¥u trÃºc ráº¥t há»¯u Ã­ch, Ä‘áº·c biá»‡t lÃ  khi giao tiáº¿p vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u hoáº·c chuyá»ƒn Ä‘á»•i thÃ´ng Ä‘iá»‡p tá»« cÃ¡c socket, v.v. ChÃºng thÆ°á»ng lÃ  bÆ°á»›c Ä‘áº§u tiÃªn trong quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u tá»« cÆ¡ sá»Ÿ dá»¯ liá»‡u thÃ nh cÃ¡c Ä‘á»‘i tÆ°á»£ng cá»§a chÆ°Æ¡ng trÃ¬nh.</p>

<p>Má»™t sá»‘ phá»• biáº¿n hÆ¡n lÃ  chuáº©n â€œbeanâ€ Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Listing 6-7. Bean cÃ³ cÃ¡c biáº¿n riÃªng Ä‘Æ°á»£c thao tÃ¡c bá»Ÿi getter vÃ  setter. Viá»‡c â€œxÃ©mâ€ bao Ä‘Ã³ng dÆ°á»ng nhÆ° lÃ m cho nhá»¯ng ngÆ°á»i theo chá»§ nghÄ©a hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng cáº£m tháº¥y Ä‘á»¡ khÃ³ chá»‹u hÆ¡n, nhÆ°ng khÃ´ng mang láº¡i lá»£i Ã­ch nÃ o Ä‘Ã¡ng ká»ƒ.</p>

<p>| Listing 6-7 <strong>address.java</strong> |
| â€” |</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Address</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">street</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">streetExtra</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">city</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">state</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">zip</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Address</span><span class="o">(</span><span class="nc">String</span> <span class="n">street</span><span class="o">,</span> <span class="nc">String</span> <span class="n">streetExtra</span><span class="o">,</span>
                    <span class="nc">String</span> <span class="n">city</span><span class="o">,</span> <span class="nc">String</span> <span class="n">state</span><span class="o">,</span> <span class="nc">String</span> <span class="n">zip</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">street</span> <span class="o">=</span> <span class="n">street</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">streetExtra</span> <span class="o">=</span> <span class="n">streetExtra</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">city</span> <span class="o">=</span> <span class="n">city</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">zip</span> <span class="o">=</span> <span class="n">zip</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getStreet</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">street</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getStreetExtra</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">streetExtra</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getCity</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">city</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getState</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">state</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getZip</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">zip</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="active-records">Active Records</h3>

<p>Active Record lÃ  cÃ¡c hÃ¬nh thá»©c DTO Ä‘áº·c biá»‡t. ChÃºng lÃ  cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u vá»›i cÃ¡c biáº¿n public, Ä‘Ã´i khi cÃ³ cÃ¡c phÆ°Æ¡ng thá»©c nhÆ° <code class="language-plaintext highlighter-rouge">Save</code> vÃ  <code class="language-plaintext highlighter-rouge">Find</code>. ThÃ´ng thÆ°á»ng cÃ¡c Active Record lÃ  dá»¯ liá»‡u Ä‘Æ°á»£c gá»­i trá»±c tiáº¿p tá»« cÃ¡c báº£ng trong cÆ¡ sá»Ÿ dá»¯ liá»‡u hoáº·c cÃ¡c nguá»“n dá»¯ liá»‡u khÃ¡c.</p>

<p>Tháº­t khÃ´ng may, chÃºng ta thÆ°á»ng tháº¥y cÃ¡c nhÃ  phÃ¡t triá»ƒn Ä‘á»‘i xá»­ vá»›i cáº¥u trÃºc nÃ y nhÆ° thá»ƒ chÃºng lÃ  Ä‘á»‘i tÆ°á»£ng báº±ng cÃ¡ch Ä‘áº·t cÃ¡c phÆ°Æ¡ng thá»©c nghiá»‡p vá»¥ vÃ o chÃºng. Äiá»u nÃ y tháº­t nguy hiá»ƒm vÃ¬ nÃ³ táº¡o ra con quÃ¡i váº­t mang tÃªn con lai nhÆ° Ä‘Ã£ Ä‘á» cáº­p bÃªn trÃªn.</p>

<p>Giáº£i phÃ¡p, táº¥t nhiÃªn lÃ  coi cÃ¡c Active Record lÃ  má»™t cáº¥u trÃºc, Ä‘á»“ng thá»i táº¡o cÃ¡c Ä‘á»‘i tÆ°á»£ng riÃªng biá»‡t chá»©a cÃ¡c phÆ°Æ¡ng thá»©c nghiá»‡p vá»¥ vÃ  áº©n dá»¯ liá»‡u cá»§a chÃºng Ä‘i.</p>

<h2 id="káº¿t-luáº­n">Káº¿t luáº­n</h2>

<p>Äá»‘i tÆ°á»£ng hiá»ƒn thá»‹ ra cÃ¡c hÃ nh Ä‘á»™ng vÃ  áº©n dá»¯ liá»‡u, Ä‘iá»u nÃ y giÃºp dá»… dÃ ng thÃªm cÃ¡c loáº¡i Ä‘á»‘i tÆ°á»£ng má»›i mÃ  khÃ´ng thay Ä‘á»•i cÃ¡c hÃ nh vi hiá»‡n cÃ³. NhÆ°ng nÃ³ cÅ©ng lÃ m cho viá»‡c thÃªm cÃ¡c phÆ°Æ¡ng thá»©c má»›i vÃ o Ä‘á»‘i tÆ°á»£ng hiá»‡n cÃ³ trá»Ÿ nÃªn khÃ³ khÄƒn. Cáº¥u trÃºc dá»¯ liá»‡u phÆ¡i bÃ y dá»¯ liá»‡u vÃ  khÃ´ng cÃ³ nhiá»u phÆ°Æ¡ng thá»©c, Ä‘iá»u nÃ y giÃºp dá»… dÃ ng thÃªm cÃ¡c phÆ°Æ¡ng thá»©c má»›i vÃ o cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u hiá»‡n cÃ³ nhÆ°ng láº¡i lÃ m cho viá»‡c thÃªm cáº¥u trÃºc má»›i vÃ o cÃ¡c hÃ m hiá»‡n cÃ³ trá»Ÿ nÃªn khÃ³ khÄƒn.</p>

<p>Trong báº¥t ká»³ há»‡ thá»‘ng nÃ o, Ä‘Ã´i khi chÃºng tÃ´i sáº½ muá»‘n viá»‡c thay Ä‘á»•i dá»¯ liá»‡u trá»Ÿ nÃªn linh hoáº¡t, vÃ¬ váº­y chÃºng tÃ´i chá»n Ä‘á»‘i tÆ°á»£ng cho há»‡ thá»‘ng. NhÆ°ng thá»‰nh thoáº£ng chÃºng tÃ´i láº¡i cáº§n thÃªm nhá»¯ng hÃ m má»›i, vÃ  vÃ¬ váº­y chÃºng tÃ´i cáº§n chá»n kiá»ƒu cáº¥u trÃºc. CÃ¡c nhÃ  phÃ¡t triá»ƒn pháº§n má»m giá»i luÃ´n biáº¿t cÃ¡ch tiáº¿p cáº­n tá»‘t nháº¥t trong nhá»¯ng trÆ°á»ng há»£p nÃ y.</p>

<h2 id="tham-kháº£o">Tham kháº£o</h2>

<p><em>Refactoring: Improving the Design of Existing Code</em>, Martin Fowler et al., Addison-Wesley, 1999.</p>

  </div><a class="u-url" href="/clean-code/chaper-06" hidden></a>

  <footer class="post-footer">
    <nav class="post-navigation">
      
        <a href="/clean-code/chaper-05" class="prev-post">â† ChÆ°Æ¡ng 5 - Äá»‹nh dáº¡ng code</a>
      
      
        <a href="/clean-code/chaper-07" class="next-post">ChÆ°Æ¡ng 7 - Xá»­ lÃ½ lá»—i â†’</a>
      
    </nav>
  </footer>
  
</article>

      </div>
    </main>

    <!--<footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/hondanho" title="hondanho"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
-->

    <a href="#" id="back-to-top">
      Back To Top &uarr;
    </a>
  </body>

</html>
